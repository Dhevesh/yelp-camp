<%include ../partials/header%>
<div class="container pt-4">
	<div class="row">
		<div class="col-3">
			<p class="lead">Yelp! Camp</p>
			<div class="list-group">
				<li class="list-group-item active">Info 1</li>
				<li class="list-group-item">Info 2</li>
				<li class="list-group-item">Info 3</li>
			</div>
		</div>
		<div class="col-9">
			<div class="card">
				<img class="card-img-top img-large" src="<%=campground.image%>">
				<div class="card-header">
					<span class="card-head-text"><a href=""><%=campground.name%></a></span>
					<div class="float-right"><h6>$<%=campground.price%>/night</h6></div>
					<div>
						<span class="time">Submitted by : <%=campground.author.name%></span><span class="time"> - <%=moment(campground.dateAdded).fromNow()%></span>
					</div>
					<div>
						<form method="POST">
							<button id="likeButton" type="submit" formaction="/campgrounds/<%=campground._id%>/like">
								<span id="likeSpan" class="badge badge-pill badge-secondary"><span class="px-2"><%=campground.likes.length%></span><i class="fas fa-thumbs-up p-1"></i></span>
							</button>
							<button id="dislikeButton" type="submit" formaction="/campgrounds/<%=campground._id%>/dislike">
								<span id="dislikeSpan" class="badge badge-pill badge-secondary"><i class="fas fa-thumbs-down p-1"></i><span class="px-2"><%=campground.dislikes.length%></span></span>
							</button>
						</form>
					</div>
						
				</div>
				<div class="card-body">
					<% if(currentUser && campground.author.id.equals(currentUser._id)){ %>
						<a href="/campgrounds/<%=campground._id%>/edit"><span><i class="far fa-edit"></i></span></a>
						<form class="delete-form" action="/campgrounds/<%=campground._id%>/delete?_method=DELETE" method="POST">
							<button><span><i class="far fa-trash-alt"></i></span></button>
						</form>
					<% } %>
					
					<p class="card-text"><%=campground.description%></p>
				</div>
			</div>
			<div>
				<div class="text-right">
					<a class="btn btn-sm btn-success" href="/campgrounds/<%=campground._id%>/comments/new">Add Comment</a>
				</div>
				<hr>
				<% if (!campground.comments[0]){ %>
					<div>Be the first to comment on this campsite!</div>
				<% } else { %>
					<%campground.comments.forEach((comment)=>{%>
						<div class="row">
							<div class="col-4"> <!--review author-->
								<strong><%=comment.author.name%></strong>
								<span class="pull-right time">
									<%=moment(comment.dateAdded).fromNow()%>
								</span>
								<div>
									<%for (i = 0; i < author.length; i ++){ %>
										<%if (author[i].id == comment.author.id){ %>
											User since: <%=moment(author[i].created).format("MMM YYYY")%>
										<%} %>
										
									<%} %>
								</div>
								<div>
									Posts: 3	
								</div>
								<div>
									Reviews: 20
								</div>
								<div>
								<% if (currentUser && comment.author.id.equals(currentUser._id)){ %>
									<a href="/campgrounds/<%=campground._id%>/comments/<%=comment._id%>/edit"><span><i class="far fa-edit"></i></span></a>
									<form class="delete-form" action="/campgrounds/<%=campground._id%>/comments/<%=comment._id%>?_method=DELETE" method="POST">
										<button><span><i class="far fa-trash-alt"></i></span></button>
									</form>
								<% }; %>
								</div>
								
							</div>
							<div class="col-4"> <!--review body-->
								<p>
									<%=comment.text%>
								</p>
							</div>
							<div class="col-4 text-right"> <!--camp rating-->
								Rating: 5 Stars
							</div>
						</div>
					<%})%>
				<%} %>
			</div> <!--comments div end-->
		</div>
	</div>
</div>
<%include ../partials/footer%>